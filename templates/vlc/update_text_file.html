<!-- Popup Modal -->
<div id="updateTextFileModal" class="modal">
    <div class="modal-content">
        <div class="modal-header">
            <h2>Update TextFile</h2>
            <button class="close-btn" onclick="closePopup()">&times;</button>
        </div>
        <div class="modal-body">
            <form id="updateTextFileForm" method="POST" action=".">
                {% csrf_token %}
                <div class="form-group">
                    <label for="voiceId">Voice ID</label>
                    <input type="text" id="voiceId" name="voice_id" value="{{ textfile.voice_id }}" required>
                </div>
                <div class="form-group">
                    <label for="apiKey">API Key</label>
                    <input type="text" id="apiKey" name="api_key" value="{{ textfile.api_key }}" required>
                </div>
                <div class="form-actions">
                    <button type="submit" class="submit-btn">Update</button>
                    <button type="button" class="cancel-btn" onclick="closePopup()">Cancel</button>
                </div>
            </form>
        </div>
    </div>
</div>


<script>
    function openPopup() {
        document.getElementById('updateTextFileModal').style.display = 'block';
    }

    function closePopup() {
        document.getElementById('updateTextFileModal').style.display = 'none';
    }

    document.getElementById('updateTextFileForm').onsubmit = function(event) {
        event.preventDefault();
        var form = this;
        
        var xhr = new XMLHttpRequest();
        xhr.open('POST', form.action, true);
        xhr.setRequestHeader('X-CSRFToken', form.querySelector('[name=csrfmiddlewaretoken]').value);
        xhr.onreadystatechange = function() {
            if (xhr.readyState === 4) {
                if (xhr.status === 200) {
                    alert('Update successful!');
                    closePopup();
                } else {
                    alert('Error updating TextFile.');
                }
            }
        };
        
        // Form data
        var formData = new FormData(form);
        xhr.send(formData);
    };
</script>
